{% extends 'edtech_project/base.html' %}

{% load static %}

<!DOCTYPE html>

{% block head %}
    <title>Edtech project</title>
    <link rel="stylesheet" href="{% static 'edtech_project/style.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>

    <!-- Defines color for highlighting -->
    <!-- START CODE FROM CHATGPT -->
    <style>
        /* drag and drop background syntax color (slightly darker than background) */
        .highlight-drag-and-drop pre code.hljs {
            background: #222223 !important; /* 222223 */
        }

        /* default background syntax color (matches website background) */
        .highlight-default pre code.hljs {
            background: #2E1F27 !important;
        }

    </style>
    <!-- END CODE FROM CHATGPT -->

{% endblock %}

{% block content %}
<h3 class="practice-description">Please use the buttons below to generate problems.</h3> <br>

<script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>

<!--START CODE FROM CHATGPT-->
<script>
    //let currentFetchController = null;
    let initial_chatGPTresponse = "";

    //debounce logic
    let isFetching = false;

    /** 
     * Called when a user clicks a difficulty button ("Easy", "Medium", "Hard").
     * Generates a problem for the user to solve.
     */
    function fetchChatGPTResponse(message, difficultyLevel, retries=3, delay=1000) {

        //disables problem generation until current request is processed (and shown to user)
        if (isFetching) {
            console.log("Button press ignored; fetching in progress");
            return;
        }

        isFetching = true;

        //Define variables for relevant elements
        let chatResponseDiv = document.getElementById('chatgpt-response');
        let userInputDiv = document.getElementById('user-input-div');
        let userSubmit = document.getElementById('submit-answer');
        let feedbackMessage = document.getElementById("feedback");
        let hintsGroup = document.getElementById("hints-group");
        let hintsButton = document.getElementById("hints-button");
        let userInput = document.getElementById("user-input");
        let instructionsDiv = document.getElementById('instructions');
        let skeletonLoader = document.getElementById('skeleton-loader');
        let userInputAnswer = document.getElementById('user-input-answer');
        let resetButton = document.getElementById('reset-problem');
        let hints = document.getElementById("hints");
        let whyButton = document.getElementById("why-button");
        let explanation = document.getElementById("explanation");

        //setting defaults when button is clicked (removing submit and hint buttons, etc.)
        resetButton.style.visibility = 'hidden';
        userInputDiv.style.display = "none";
        userSubmit.style.display = "none";
        feedbackMessage.textContent = "";
        hintsGroup.style.visibility = "hidden";
        hintsGroup.style.display = "flex";
        hintsButton.style.display = "none";
        instructionsDiv.innerHTML = "";
        chatResponseDiv.innerHTML = "";
        skeletonLoader.style.display = 'block';
        whyButton.style.display = "none";
        explanation.style.display = "none";
        chatResponseDiv.contentEditable = "false";
        chatResponseDiv.autocomplete = "false";
        chatResponseDiv.spellcheck = false;

        //direct to /practice/, see urls.py for views.py function call
        fetch('/practice/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-Requested-With': 'XMLHttpRequest',
                'X-CSRFToken': '{{ csrf_token }}'
            },

            //sends these variables to /practice/
            body: JSON.stringify({
                message: message,
                difficulty_level: difficultyLevel
            })
        })

        //when we get a response, do this
        .then(response => {

            //response is not okay, throw an error
            if (!response.ok) {
                throw new Error(`HTTP error! Status: ${response.status}`);
                chatResponseDiv.innerHTML = "An error has occurred. Please try again or contact the administrator."
            }
            
            return response.json();
        })

        //we received data
        .then(data => {
            //info sent to user, no longer fetching request
            isFetching = false;

            userSubmit.style.display = "inline-block";
            userSubmit.style.visibility = "visible";
            userInputDiv.style.display = "inline-block";

            //START CODE FROM CHATGPT
            let existingSortable = document.getElementById("sortable-code-block");
            //console.log("existingSortable:", existingSortable);
            if (existingSortable) {
                const sortableInstance = Sortable.get(existingSortable);
                console.log("sortableInstance:", sortableInstance);
                if (sortableInstance) {
                    sortableInstance.destroy();
                    console.log("Sortable instance destroyed");
                }
                existingSortable.remove();
            }
            //END CODE FROM CHATGPT

            skeletonLoader.style.display = "none";
            userInput.value = "";
            hints.textContent = "";
            feedbackMessage.textContent = "";
            hintsGroup.style.visibility = "visible";
            hintsButton.style.visibility = "visible";
            hintsButton.style.display = "flex";

            //we received data from chatgpt
            if (data.chatgpt_response) {
                document.getElementById("problem-type").value = data.problem_type;
                document.getElementById("correct-answer").value = data.correct_answer;
                chatResponseDiv.classList.remove("highlight-drag-and-drop");
                chatResponseDiv.classList.add("highlight-default");

                //if problem type is "determine_output" (standard)
                if (document.getElementById("problem-type").value === "determine_output") {
                    //format the output
                    let formattedResponse = data.chatgpt_response
                    .replace(/```(\w+)?\n([\s\S]+?)```/g, function(match, lang, code) {
                        lang = lang || 'plaintext';  // Default to plaintext if no language is specified
                        return `<pre><code class="language-${lang}">${code}</code></pre>`;
                    });

                    //set elements specific to "determine_output" problem type
                    chatResponseDiv.innerHTML = `<p><strong> </strong></p>` + formattedResponse;
                    instructionsDiv.innerHTML = "What printed value shows when the above code is ran? Remember that the 'output' variable is rounded to 3 decimals! Ex: 1.2468 -> 1.247"
                    userInput.setAttribute("required", "true");
                    userInput.style.display = "inline-block";
                    userInputAnswer.style.display = "inline-block";

                    //performs syntax highlighting
                    document.querySelectorAll('pre code').forEach((block) => {
                        hljs.highlightElement(block);
                        });

                }
                //END CODE FROM CHATGPT

                //if problem type is "fill_in_vars"
                else if (document.getElementById("problem-type").value === "fill_in_vars") {
                    let formattedResponse = data.chatgpt_response
                    //START CODE FROM CHATGPT
                    .replace(/```(\w+)?\n([\s\S]+?)```/g, function(match, lang, code) {
                        lang = lang || 'plaintext';  // Default to plaintext if no language is specified
                        return `<pre><code class="language-${lang}">${code}</code></pre>`;
                    });
                    //END CODE FROM CHATGPT

                    //set elements specific to "fill_in_vars" problem type
                    chatResponseDiv.innerHTML = `<p><strong> </strong></p>` + formattedResponse;
                    document.getElementById("initial-response").value = chatResponseDiv.textContent;
                    document.getElementById("initial-response-raw").value = chatResponseDiv.innerHTML;
                    instructionsDiv.innerHTML = "Rename the missing function and variable names to something more appropriate by editing the above code, then submit your answer when complete. Note: small differences in function/variable names are okay; the grader is lenient. Use the 'Reset Problem' button in the upper-right corner if you need to reload the original problem."
                    chatResponseDiv.contentEditable = "true";
                    userInput.style.display = "none";
                    userInputAnswer.style.display = "none";
                    userInput.removeAttribute("required");
                    resetButton.style.visibility = 'visible';

                    //chatReponseDiv is editable, override default behavior of creating a div when the user presses enter

                    //START CODE FROM CHATGPT
                    chatResponseDiv.addEventListener("keypress", function (event) {
                        if (event.key === "Enter") {
                            event.preventDefault(); // Prevents default <div> insertion
                            document.execCommand("insertLineBreak"); // Inserts a <br> instead
                        }
                    });
                    //END CODE FROM CHATGPT

                    //performs syntax hightlighting
                    document.querySelectorAll('pre code').forEach((block) => {
                        hljs.highlightElement(block);
                        });
                    }

                else if (document.getElementById("problem-type").value == "drag_and_drop") {
                    //set elements specific to "drag_and_drop" problem type
                    chatResponseDiv.classList.remove("highlight-default");
                    chatResponseDiv.classList.add("highlight-drag-and-drop");
                    instructionsDiv.innerHTML = "Rearrange the above code so it runs correctly by dragging and dropping each line, then click Submit. Small differences in order (declaring variables, for example) do not matter; the grader is lenient.";
                    userInput.style.display = "none";
                    userInputAnswer.style.display = "none";
                    userInput.removeAttribute("required");

                    //START CODE FROM CHATGPT
                    //separate each line of code
                    let codeLines = data.chatgpt_response.split("\n").filter(line => line.trim() !== "");

                    //create a div container for each line of code
                    let container = document.createElement("div");

                    //setting attributes for each div
                    container.id = "sortable-code-block";
                    container.style.display = "flex";
                    container.style.flexDirection = "column";
                    container.style.gap = "2px";
                    container.style.marginTop = "5px";
                    container.style.marginBottom = "10px";

                    codeLines.forEach((line, index) => {
                        let block = document.createElement("div");
                        block.className = "draggable-line";
                        block.setAttribute("data-index", index);
                        
                        // Create the pre and code tags for code highlighting
                        let codeContainer = document.createElement("pre");
                        let codeElement = document.createElement("code");
                        codeElement.className = "language-python";
                        codeElement.textContent = line;
                        
                        // Apply styles to remove unwanted borders/padding
                        codeContainer.style.margin = "0"; // Remove margin
                        codeContainer.style.padding = "0"; // Remove padding
                        codeElement.style.margin = "0"; // Remove margin from code
                        codeElement.style.padding = "0"; // Remove padding from code
                        
                        // Append the code element to the pre container, and then the pre container to the block
                        codeContainer.appendChild(codeElement);
                        block.appendChild(codeContainer);

                        // Style the block itself
                        block.style.padding = "5px 2px";
                        block.style.border = "none";
                        block.style.backgroundColor = "#222223";
                        block.style.cursor = "move";
                        block.style.margin = "0";
                        block.style.boxSizing = "border-box"; // Make sure padding is within the width

                        // Add the block to the container
                        container.appendChild(block);
                    });

                    // Add div to the container
                    chatResponseDiv.appendChild(container);

                    // Use a small timeout to let the DOM update/render
                    setTimeout(() => {
                        const sortableTarget = document.querySelector("#sortable-code-block");
                        
                        if (!sortableTarget) {
                            console.warn("Sortable container not found!");
                            return;
                        }

                        Sortable.create(sortableTarget, {
                            animation: 150,
                        });

                    }, 50);

                    //END CODE FROM CHATGPT

                    // Save original output if needed for answer checking
                    document.getElementById("initial-response").value = data.unmixed_lines;

                    document.querySelectorAll('.draggable-line pre code').forEach((block) => {
                        hljs.highlightElement(block);
                    });

                }

            }

            //there was an error retrieving the chatgpt data, throw an error
            else {
                chatResponseDiv.innerHTML = `<p style="color: red;">Error: ${data.error || 'Unknown error'}</p>`;
            }

        })

        //START CODE FROM CHATGPT
        //there was an error retreiving data
        .catch(error => {

            //set isFetching to false so we can try again
            isFetching = false;
            if (retries > 0) {
            // Retry with exponential backoff
            console.log(`Retrying... Attempts left: ${retries}`);
            setTimeout(() => {
                fetchChatGPTResponse(message, difficultyLevel, retries - 1, delay * 2); // Increase delay for next attempt
            }, delay);

            } else {
                skeletonLoader.style.display = "none";
                // Show error message after max retries are reached
                console.error('Request failed after multiple attempts. ', error);
                document.getElementById('chatgpt-response').innerHTML = '<p style="color: red;">Failed to fetch response from ChatGPT after several attempts.</p>';
            }
        });
        //END CODE FROM CHATGPT
}

/**
 * Called when user clicks the Submit button.
 * Calls into functions that check the user's input against the correct answer.
 */ 
function submitUserAnswer() {
    const userSubmit = document.getElementById('submit-answer');
    const difficulty = document.getElementById('difficulty').value;
    const hintsButton = document.getElementById("hints-button");
    const problemType = document.getElementById("problem-type").value;
    const whyButton = document.getElementById("why-button");
    const hintsGroup = document.getElementById("hints-group");
    const resetProblem = document.getElementById("reset-problem");
    const feedbackMessage = document.getElementById("feedback");

    let url = "";
    let payload = {
        difficulty: difficulty,
        problem_type: problemType,
    };

    try {
        if (problemType === "determine_output") {
            payload.user_input = document.getElementById("user-input").value;
            url = "/practice/check-answer/";
        }

        else if (problemType === "fill_in_vars") {
            payload.user_input = document.getElementById("chatgpt-response").textContent;
            payload.initial_chatGPTResponse = document.getElementById("initial-response").value;
            url = "/practice/check-answer-fill-in-vars/";
        }

        else if (problemType === "drag_and_drop") {
            const blocks = document.querySelectorAll('#sortable-code-block .draggable-line code');
            const codeLines = Array.from(blocks).map(code => code.textContent);
            const finalCode = codeLines.join('\n');

            payload.user_input = finalCode;
            payload.final_code = finalCode;
            payload.initial_chatGPTResponse = document.getElementById("initial-response").value;
            payload.correct_answer = document.getElementById("correct-answer").value;
            url = "/practice/check-answer-drag-and-drop/";
        }

        fetch(url, {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "X-Requested-With": "XMLHttpRequest",
                "X-CSRFToken": "{{ csrf_token }}"
            },
            body: JSON.stringify(payload)
        })
        .then(response => response.json())
        .then(data => {
            if (data.message.includes("Correct")) {
                feedbackMessage.textContent = "Correct!";
                feedbackMessage.style.color = "#6eff6e";
                userSubmit.style.display = "none";
                userSubmit.style.visibility = "hidden";
                hintsButton.style.visibility = "hidden";
                hints.innerHTML = "";
                hintsGroup.style.display = "none";
                whyButton.style.display = "flex";
                whyButton.style.visibility = "visible";
                resetProblem.style.visibility = "hidden";
            } else {
                feedbackMessage.textContent = data.message || "Incorrect";
                feedbackMessage.style.color = "#f74364";
                userSubmit.style.display = "inline-block";
            }
        });

    } catch (error) {
        console.error("Error during submission:", error);
    }
}

/**
 * Sets the difficulty of the hidden element, 'difficulty'
 */ 
function setDifficulty(level) {
    document.getElementById("difficulty").value = level;
}

/**
 * Handles the button press; gets response from backend
 */ 
function handleButtonPress(query, difficultyLevel) {
    //retrieve session data, see which prompt was generated
    fetchChatGPTResponse(query, difficultyLevel)
    setDifficulty(difficultyLevel)
    
}

/**
 * Called when the user clicks the 'Get a hint!' button.
 * Sends a query to ChatGPT that returns a hint for the user.
 */
function generateHint() {
    let hints = document.getElementById("hints");
    let userInput = document.getElementById("user-input").value;
    var chatResponseDiv = document.getElementById('chatgpt-response').textContent;
    let difficultyLevel = document.getElementById('difficulty').value;
    let problemType = document.getElementById('problem-type').value;

    let hintsSkeletonLoader = document.getElementById('hints-skeleton-loader');
    hintsSkeletonLoader.style.display = "inline-block";
    hints.textContent = "";

    fetch("/practice/generate-hint/", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "X-Requested-With": "XMLHttpRequest",
            "X-CSRFToken": "{{ csrf_token }}"
        },
        body: JSON.stringify({
            user_input: userInput,
            difficulty: difficultyLevel,
            chatGPTResponse: chatResponseDiv,
            problem_type: problemType,
        })
    })

    .then(response => response.json())
    .then(data => {
        hintsSkeletonLoader.style.display = "none";
        let hintText = data.message;
        //START CODE FROM CHATGPT
        hintText = hintText.replace(/`([^`]+)`/g, '<code>$1</code>');
        //END CODE FROM CHATGPT
        hints.innerHTML = hintText;
        
        
    })
    .catch(error => console.error("Error:", error));
    
}

function handleResetProblem() {
    let chatResponseDiv = document.getElementById('chatgpt-response');
    chatResponseDiv.innerHTML = document.getElementById('initial-response-raw').value;
    hljs.highlightAll();
}

//START CODE FROM CHATGPT
document.addEventListener("DOMContentLoaded", function () {
    let userInputField = document.getElementById("user-input");
    let feedbackMessage = document.getElementById("feedback");
    let chatgptResponse = document.getElementById("chatgpt-response");

    if (userInputField) {
        userInputField.addEventListener("input", function () {
            //END CODE FROM CHATGPT
            feedbackMessage.textContent = "";
        });
    }

    if (chatgptResponse) {
        chatgptResponse.addEventListener("input", function () {
            feedbackMessage.textContent = "";
        })
    }

});

function generateExplanation() {
    let userInput = document.getElementById("user-input").value;
    var chatResponseDiv = document.getElementById('chatgpt-response').textContent;
    let whyButton = document.getElementById('why-button');
    let problemType = document.getElementById("problem-type").value;
    let correctAnswer = document.getElementById("correct-answer").value;
    let explanationSkeletonLoader = document.getElementById('explanation-skeleton-loader');
    explanationSkeletonLoader.style.display = "inline-block";

    fetch("/practice/generate-explanation/", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "X-Requested-With": "XMLHttpRequest",
            "X-CSRFToken": "{{ csrf_token }}"
        },
        body: JSON.stringify({
            user_input: userInput,
            chatGPTResponse: chatResponseDiv,
            problem_type: problemType,
            correct_answer: correctAnswer,
        })
    })

    .then(response => response.json())
    .then(data => {
        explanationSkeletonLoader.style.display = "none";
        let explanation = document.getElementById("explanation");
        let explanationText = data.message;
        //START CODE FROM CHATGPT
        explanationText = explanationText.replace(/`([^`]+)`/g, '<code>$1</code>');
        //END CODE FROM CHATGPT
        explanation.innerHTML = explanationText;
        whyButton.style.visibility = 'hidden';
        explanation.style.display = 'block';
        
    })
    .catch(error => console.error("Error:", error));

}

</script>

{% csrf_token %}
<button class="button-difficulty" id="button-easy" data-difficulty="Easy" onclick="handleButtonPress('I\'d like you to generate a snippet of Python code for me. The purpose of the code is educational, so it should give students practice in reading code. Here are the general specifications: The code must between 5 and 10 lines long. The code must not have any annotations or comments. Variable and function names must make sense (be something a human would write). The code should do something that would be useful to a human. Please use i, j, and k for iterators in for loops. At the end of the code, there should be a line that causes it to output a number or phrase (a student should be able to type its output into a text box for practicing purposes). The output should be limited to 15 characters or fewer. It should not be obvious what the code is doing, but it should be decipherable after looking at it for a few minutes. Here are some examples of what the code could do: Ex1: shift an element in a list/array to the right/left by a certain number of spaces, Ex2: generate a Fibonacci sequence, Ex3: create a basic graph structure, then perform an operation on it, Ex4: edit a string in a unique way, Ex5: do something with prime numbers. I expect you to pull from physics, chemistry, biology, and computer science for inspiration. Please randomly choose one these fields. Please generate a piece of code with these specifications. These are only examples, I expect you to create a new example that is unique. Internally, please generate a random number between 1 and 10, inclusive. Please determine with 0.5 probability whether or not the example uses a for loop. Please store the output of the code in a variable called \'output\', where the last line prints the output variable. Do not include descriptions of the code. Do not include input() functions in the code. Do not use random() functions.', 'Easy')"> Easy </button>
{% csrf_token %}
<button class="button-difficulty" id="button-medium" data-difficulty="Medium" onclick="handleButtonPress('I\'d like you to generate a snippet of Python code for me. The purpose of the code is educational, so it should give students practice in reading code. Here are the general specifications: The code must between 10 and 30 lines long. The code must not have any annotations or comments. Variable and function names must make sense (be something a human would write). The code should do something that would be useful to a human. Please use i, j, and k for iterators in for loops. At the end of the code, there should be a line that causes it to output a number or phrase (a student should be able to type its output into a text box for practicing purposes). The output should be limited to 15 characters or fewer. It should not be obvious what the code is doing, but it should be decipherable after looking at it for a few minutes. Here are some examples of what the code could do: Ex1: shift an element in a list/array to the right/left by a certain number of spaces, Ex2: generate a Fibonacci sequence, Ex3: create a basic graph structure, then perform an operation on it, Ex4: edit a string in a unique way, Ex5: do something with prime numbers. I expect you to pull from physics, chemistry, biology, and computer science for inspiration. Please randomly choose one these fields. Please generate a piece of code with these specifications. These are only examples, I expect you to create a new example that is unique. Internally, please generate a random number between 1 and 10, inclusive. Please determine with 0.5 probability whether or not the example uses a for loop. Please store the output of the code in a variable called \'output\', where the last line prints the output variable. Do not include descriptions of the code. Do not include input() functions in the code. Do not use random() functions.', 'Medium')"> Medium </button>
{% csrf_token %}
<button class="button-difficulty" id="button-hard" data-difficulty="Hard" onclick="handleButtonPress('I\'d like you to generate a snippet of Python code for me. The purpose of the code is educational, so it should give students practice in reading code. Here are the general specifications: The code must between 50 and 100 lines long. The code must not have any annotations or comments. Variable and function names must make sense (be something a human would write). The code should do something that would be useful to a human. Please use i, j, and k for iterators in for loops. At the end of the code, there should be a line that causes it to output a number or phrase (a student should be able to type its output into a text box for practicing purposes). The output should be limited to 15 characters or fewer. It should not be obvious what the code is doing, but it should be decipherable after looking at it for a few minutes. Here are some examples of what the code could do: Ex1: shift an element in a list/array to the right/left by a certain number of spaces, Ex2: generate a Fibonacci sequence, Ex3: create a basic graph structure, then perform an operation on it, Ex4: edit a string in a unique way, Ex5: do something with prime numbers. I expect you to pull from physics, chemistry, biology, and computer science for inspiration. Please randomly choose one these fields. Please generate a piece of code with these specifications. These are only examples, I expect you to create a new example that is unique. Internally, please generate a random number between 1 and 10, inclusive. Please determine with 0.5 probability whether or not the example uses a for loop. Please store the output of the code in a variable called \'output\', where the last line prints the output variable. Do not include descriptions of the code. Do not include input() functions in the code. Do not use random() functions.', 'Hard')"> Hard </button>

{% csrf_token %}
<button class="reset-problem" id="reset-problem" style="visibility: hidden" onclick="handleResetProblem()"> Reset Problem</button>

<div id="chatgpt-response"></div>
<div id="skeleton-loader">
    <div class="first-skeleton"></div>
    <div class="skeleton"></div>
    <div class="skeleton"></div>
    <div class="skeleton"></div>
    <div class="indented-skeleton"></div>
    <div class="skeleton"></div>
    <div class="skeleton"></div>
    <div class="skeleton"></div>
    <br>
    <div class="first-skeleton"></div>
    <div class="skeleton"></div>
    <div class="skeleton"></div>
    <div class="indented-skeleton"></div>
    <div class="indented-skeleton"></div>
    <div class="skeleton"></div>
    <div class="skeleton"></div>
</div>
<div id="instructions"></div> <br>

<!--START CODE FROM CHATGPT-->
<input type="hidden" id="difficulty" name="difficulty" value="">
<input type="hidden" id="problem-type" name="problem-type" value="">
<input type="hidden" id="initial-response" name="initial-response" value="">
<input type="hidden" id="initial-response-raw" name="initial-response-raw" value="">
<input type="hidden" id="correct-answer" name="correct-answer" value="">


<div class="form-group form-inline" id="user-input-div" style="display: none;">
    <form method="POST" id="user-input-form" onsubmit="event.preventDefault(); submitUserAnswer();">
        <div class='user-input-line'>
            <label for="user-input" id="user-input-answer" class="practice-description">Answer: </label>
            <input type="text" id="user-input" name="user-input" size="30" required />
        </div>
<!--END CODE FROM CHATGPT-->
        <div class="submit-line">
            {% csrf_token %}
            <button id="submit-answer" type="submit">Submit</button>
            <button id="why-button" type="button" onclick="generateExplanation()">Explanation</button>
            <p id="feedback"></p>
            
        </div>

        <p id="explanation"></p>

        <div id="explanation-skeleton-loader">
            <div class="explanation-skeleton"></div>
            <div class="explanation-skeleton"></div>
            <div class="explanation-skeleton"></div>
            <div class="explanation-skeleton"></div>
            <div class="explanation-skeleton-short"></div>
        </div>

    </form>
</div>

<div class="hints-group" id="hints-group">
    <div class="hints-button-div">
        <form method="POST" id="hints-form" onsubmit="event.preventDefault(); generateHint()">
            {% csrf_token %}
            <button id="hints-button" type="submit">Get a hint!</button>
        </form>
    </div>

    <div class="hints-text-div">
        <p id="hints"> </p>
    </div>

    <div id="hints-skeleton-loader">
        <div class="hints-skeleton"></div>
        <div class="hints-skeleton"></div>
        <div class="hints-skeleton-short"></div>
    </div>
    
</div>

{% endblock %}

<!-- General explanation for flow of code:
-User navigates to /practice/, which renders the practice.html page
-User clicks a difficulty button
-fetchChatGPTResponse() is run which sends the request to the /practice/
-urls.py matches /practice/ with a function in views.py (practice()) which is then run
-Python code queries ChatGPT, retrieves and validates output
-A JsonResponse() is returned to the frontend with relevant variables
-Frontend processes the request and displays relevant information to the user
-->