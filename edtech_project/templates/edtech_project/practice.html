{% extends 'edtech_project/base.html' %}

{% load static %}

<!DOCTYPE html>

{% block head %}
    <title>Edtech project</title>
    <link rel="stylesheet" href="{% static 'edtech_project/style.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script src="{% static 'edtech_project/js/practice.js' %}"></script>

    <!-- Defines color for highlighting -->
    <!-- START CODE FROM CHATGPT -->
    <style>
        /* drag and drop background syntax color (slightly darker than background) */
        .highlight-drag-and-drop pre code.hljs {
            background: #222223 !important; /* 222223 */
        }

        /* default background syntax color (matches website background) */
        .highlight-default pre code.hljs {
            background: #2E1F27 !important;
        }

    </style>
    <!-- END CODE FROM CHATGPT -->

{% endblock %}

{% block content %}


<div id="instructions-and-options-box">
    <h3 class="practice-description">Please use the buttons below to generate problems.</h3>
    <button id="options-button"> Generation Options </button>
</div>

<div id="generation-options-box">
    <div id="generation-options-panel">
        <h6>testing</h6> <br>
        <p>testing2</p>
    </div>
</div>

<br>

<script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>

<!--START CODE FROM CHATGPT-->

{% csrf_token %}
<button class="button-difficulty" id="button-easy" data-difficulty="Easy" onclick="handleButtonPress('Easy')"> Easy </button>
{% csrf_token %}
<button class="button-difficulty" id="button-medium" data-difficulty="Medium" onclick="handleButtonPress('Medium')"> Medium </button>
{% csrf_token %}
<button class="button-difficulty" id="button-hard" data-difficulty="Hard" onclick="handleButtonPress('Hard')"> Hard </button>

{% csrf_token %}
<button class="reset-problem" id="reset-problem" style="visibility: hidden" onclick="handleResetProblem()"> Reset Problem</button>

<div id="chatgpt-response"></div>
<div id="skeleton-loader">
    <div class="first-skeleton"></div>
    <div class="skeleton"></div>
    <div class="skeleton"></div>
    <div class="skeleton"></div>
    <div class="indented-skeleton"></div>
    <div class="skeleton"></div>
    <div class="skeleton"></div>
    <div class="skeleton"></div>
    <br>
    <div class="first-skeleton"></div>
    <div class="skeleton"></div>
    <div class="skeleton"></div>
    <div class="indented-skeleton"></div>
    <div class="indented-skeleton"></div>
    <div class="skeleton"></div>
    <div class="skeleton"></div>
</div>
<div id="instructions"></div> <br>

<!--START CODE FROM CHATGPT-->
<input type="hidden" id="difficulty" name="difficulty" value="">
<input type="hidden" id="problem-type" name="problem-type" value="">
<input type="hidden" id="initial-response" name="initial-response" value="">
<input type="hidden" id="initial-response-raw" name="initial-response-raw" value="">
<input type="hidden" id="correct-answer" name="correct-answer" value="">


<div class="form-group form-inline" id="user-input-div" style="display: none;">
    <form method="POST" id="user-input-form" onsubmit="event.preventDefault(); submitUserAnswer();">
        <div class='user-input-line'>
            <label for="user-input" id="user-input-answer" class="practice-description">Answer: </label>
            <input type="text" id="user-input" name="user-input" size="30" required />
        </div>
<!--END CODE FROM CHATGPT-->
        <div class="submit-line">
            {% csrf_token %}
            <button id="submit-answer" type="submit">Submit</button>
            <button id="why-button" type="button" onclick="generateExplanation()">Explanation</button>
            <p id="feedback"></p>
            
        </div>

        <p id="explanation"></p>

        <div id="explanation-skeleton-loader">
            <div class="explanation-skeleton"></div>
            <div class="explanation-skeleton"></div>
            <div class="explanation-skeleton"></div>
            <div class="explanation-skeleton"></div>
            <div class="explanation-skeleton-short"></div>
        </div>

    </form>
</div>

<div class="hints-group" id="hints-group">
    <div class="hints-button-div">
        <form method="POST" id="hints-form" onsubmit="event.preventDefault(); generateHint()">
            {% csrf_token %}
            <button id="hints-button" type="submit">Get a hint!</button>
        </form>
    </div>

    <div class="hints-text-div">
        <p id="hints"> </p>
    </div>

    <div id="hints-skeleton-loader">
        <div class="hints-skeleton"></div>
        <div class="hints-skeleton"></div>
        <div class="hints-skeleton-short"></div>
    </div>
    
</div>

{% endblock %}

<!-- General explanation for flow of code:
-User navigates to /practice/, which renders the practice.html page
-User clicks a difficulty button
-fetchChatGPTResponse() is run which sends the request to the /practice/
-urls.py matches /practice/ with a function in views.py (practice()) which is then run
-Python code queries ChatGPT, retrieves and validates output
-A JsonResponse() is returned to the frontend with relevant variables
-Frontend processes the request and displays relevant information to the user
-->