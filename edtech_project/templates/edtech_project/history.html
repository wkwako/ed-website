{% extends 'edtech_project/base.html' %}

{% load static %}

{% block head %}
    <title>Edtech project</title>
    <link rel="stylesheet" href="{% static 'edtech_project/style.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
    
    <!-- START CODE FROM CHATGPT -->
    <style>
        /* default background syntax color (matches website background) */
        pre code.hljs {
            background: #2E1F27 !important;
        }

    </style>
    
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            hljs.highlightAll();
        });
    </script>

    <!-- END CODE FROM CHATGPT -->
{% endblock %}



{% block content %}
    <div class="stats">
        <h3 id="recent-problems-correct"> Recent problems correct: {{num_correct}}/{{num_entries}} </h3>
    </div>

    <!-- the data is coming from the context variable passed in history() in views.py -->
    {% for entry in history %}
        <p class="history-info">
            <!-- print general information about each problem -->
            <!-- <strong> Difficulty: </strong> {{entry.difficulty}} &nbsp; <br> -->
            <strong> Result: </strong> 
            <!--START CODE FROM CHATGPT-->
            <span class="{% if entry.is_correct %}correct-text{% else %}incorrect-text{% endif %}"> 
                {{ entry.is_correct|yesno:"Correct,Incorrect" }}
            </span> <br>
            <!--END CODE FROM CHATGPT-->
            <strong> Problem type: </strong> {{entry.get_problem_type_display}} &nbsp; <br> <br>
            <strong> Submitted code: </strong> <br> <br>

        </p>
        <pre><code class="language-python" spellcheck="false" and autocomplete="off" onblur="hljs.highlightElement(this);">{{ entry.problem_text }}</code></pre>
        <br>

        <!-- If problem type is determine_output and user got it incorrect, display correct answer -->
        {% if entry.problem_type == "determine_output" and entry.is_correct == False %}
            <p class="history-info">
                <strong> Correct answer: {{entry.correct_answer}} </strong>
            </p>
            
        {% endif %}

        {% if entry.problem_type == "fill_in_vars" and entry.is_correct == False %}
            <p class="history-info">
                <strong> Example of an acceptable answer: </strong> <br>
            </p>

            <pre><code class="language-python" spellcheck="false" and autocomplete="off" onblur="hljs.highlightElement(this);">{{ entry.correct_answer }}</code></pre>
        {% endif %}

        <!-- If problem is type drag_and_drop and user got it incorrect, display correct answer -->
        {% if entry.problem_type == "drag_and_drop" and entry.is_correct == False %}
            <p class="history-info">
                <strong> Correct code: </strong>
            </p>
            
            <pre><code class="language-python" spellcheck="false" and autocomplete="off" onblur="hljs.highlightElement(this);">{{ entry.correct_answer }}</code></pre>
        {% endif %}

        <hr>

    {% endfor %}

{% endblock %}
